\subsection{Properties of Preferences Required}
To analyze demand with preferences (and later, utility), we first need some assumptions on preferences $\succsim$:

\paragraph*{$\succsim$ is rational}
\begin{enumerate}
    \item[-] \textbf{completeness}: $\forall \mathbf{x},\mathbf{y}\in X$, it must be either $\mathbf{x}\succsim \mathbf{y}$ or $\mathbf{y}\succsim \mathbf{x}$ or both
    \item[-] \textbf{transitivity}: $\forall \mathbf{x},\mathbf{y},\mathbf{z} \in X$ $\mathbf{x} \succsim \mathbf{y},\mathbf{y}\succsim \mathbf{z}\Rightarrow \mathbf{x}\succsim \mathbf{z}$ 
\end{enumerate}

\paragraph*{$\succsim$ is desirable}
It is reasonable to assume that larger amounts of commodities are preferred. So basically, the more the better.

Here, we have two common assumption, a stronger one, and a weaker one:
\begin{enumerate}
    \item[-] \textbf{monotone} (\textit{stronger}): if $\textbf{x},\textbf{y}\in X$, $\textbf{y}\gg \textbf{x}\Rightarrow \textbf{y}\succ \textbf{x}$
    
    \textbf{strongly monotone} (\textit{even stronger}): if $\textbf{x},\textbf{y}\in X$, $\textbf{y}\geq \textbf{x}$ and $\textbf{y}\neq \textbf{x}\Rightarrow \textbf{y}\succ \textbf{x}$
    \item[-] \textbf{locally nonsatiated} (\textit{weaker}): $\forall \mathbf{x} \in X, \forall \varepsilon >0$, $\exists \mathbf{y}\in X$ s.t. $\left\Vert \mathbf{y}-\mathbf{x} \right\Vert \leq \varepsilon$ and $\mathbf{y}\succ \mathbf{x}$
\end{enumerate}
Local nonsatiation is the common used one, since it poses minimal constraints. It is easy to see that \textbf{strongly monotone} $\Rightarrow$ \textbf{monotone} $\Rightarrow$ \textbf{locally nonsatiated}, here is a proof:
If $\succsim$ is strongly monotone and $\mathbf{x} \gg \mathbf{y}$, then $\mathbf{x}\geq \mathbf{y}$ and $\mathbf{x}\neq \mathbf{y}$ and $x\succ y$, thus $\succsim$ is monotone; 
if $\succsim$ is monotone, $\mathbf{x}\in X$ and $\varepsilon>0$, let $\mathbf{y}=\mathbf{x}+\frac{\varepsilon}{\sqrt{L}}\mathbf{e}$ where $\mathbf{e}=(1,\cdots,1)\in \mathbb{R}^L$, then $\left\Vert \mathbf{y}-\mathbf{x}\right\Vert\leq \varepsilon$ and $y\succ x$, hence $\succsim$ is locally nonsatiated.

$\succsim$ will divide $X$ into 3 sets relative to $\mathbf{x}$:
\begin{enumerate}
    \item[-] \textbf{upper contour set}: $\left\{\mathbf{y}\in X\mid \mathbf{y}\succsim \mathbf{x} \right\}$  
    \item[-] \textbf{lower contour set}: $\left\{\mathbf{y}\in X \mid \mathbf{x}\succsim \mathbf{y}\right\}$ 
    \item[-] \textbf{indifferent set}: $\left\{\mathbf{y}\in X \mid \mathbf{x}\sim \mathbf{y}\right\}$ 
\end{enumerate}
and \textbf{local nonsatiation} guarantees that the indifference set is a line.

\paragraph*{$\succsim$ is convex}
$\succsim$ is \textbf{convex} if $\forall \mathbf{x}\in X$, $\mathbf{y}\succsim\mathbf{x}$ and $\mathbf{z}\succsim\mathbf{x}$ $\Rightarrow$ $\alpha \mathbf{y}+(1-\alpha)\mathbf{z}\succsim \mathbf{x},\forall \alpha \in [0,1]$; that is, the upper contour set of $\mathbf{x}$, $\left\{\mathbf{y}\in X\mid \mathbf{y}\succsim \mathbf{x} \right\}$ is convex.

Convexity assumption is one of the central assumption, it expresses two intuitive observations of economic agents:
\begin{enumerate}
    \item[(i)] diminishing marginal rates of substitution
    \item[(ii)] inclination for diversification  
\end{enumerate}

$\succsim$ is \textbf{strictly convex} if $\forall \mathbf{x}\in X$, $\mathbf{y}\succsim\mathbf{x}$ and $\mathbf{z}\succsim\mathbf{x}$ $\Rightarrow$ $\alpha \mathbf{y}+(1-\alpha)\mathbf{z}\succ \mathbf{x},\forall \alpha \in [0,1]$.

\paragraph*{$\succsim$ is continuous}
So far, we have rationality, local nonsatiation and convexity, but these are NOT enough to guarantee a preference $\succsim$ to be representable by a utility funciton. An example is \textbf{lexicographic preference relation}.
%\begin{tcolorbox}[title = {lexicographic preference relation},colframe = black, colback = white]
%    This is my first \textbf{tcolorbox}.
%\end{tcolorbox}

The lexicographic preference relation is $\mathbf{x}\succsim \mathbf{y}\Leftrightarrow \left(x_1>y_1 \right) \lor \left( x_1=y_1 \land x_2> y_2\right) \lor \cdots \lor \left( x_1=y_1 \land \cdots x_{L-1}=y_{L-1} \land x_L\geq y_L \right)$. It is complete, transitive, strongly monotone and strictly convex; BUT, there is \textbf{NO} utility function
representing it\footnote{Here is a brief proof: Suppose there is a utility function $u(\cdot)$, then for every $x_1$, we can pick a rational number $r(x_1)$ s.t. $u(x_1,2)>r(x_1)>u(x_1,1)$, if $x_1 >x_1'$, then $r(x_1)>u(x_1,1)>u(x_1',2)>r(x_1')$. Hence $r(\cdot)$ is a one-to-one function from the set of real numbers (uncountably infinite) to the set of rational numbers (countably infinite), which is mathematically impossible. Another way of proving it is: suppose there is a utility function $u(\cdot)$, $[\inf u(x,\cdot),\sup u(x,\cdot)]$ is an interval, hence if $x<y$, $\sup u(x,\cdot)<\inf u(y,\cdot)$, which is impossible}.
To guarantee utility representability, $\succsim$ needs to be continuous: $\succsim$ is continuous if it is preserved under limits, that is, $\forall \left\{\{x^n,y^n\}\right\}^{\infty}_{n=1}$ with $x^n\succsim y^n, \forall n$, $x=\lim_{n\rightarrow\infty}x^n,y=\lim_{n\rightarrow\infty}y^n\Rightarrow x\succsim y$.

Continuity can also be expressed as: $\forall \mathbf{x}$, the upper contour set $\left\{\mathbf{y}\in X\mid \mathbf{y}\succsim \mathbf{x} \right\}$ and the lower contour set $\left\{\mathbf{y}\in X\mid \mathbf{x}\succsim \mathbf{y} \right\}$ are both \textbf{closed}. Here is the proof of this equivalence: 
\begin{enumerate}
    \item[-] continuity $\rightarrow$ contour set closedness: $\forall \left\{y^n\right\}^{\infty}_{n=1}$, let $x^n=x,\forall n$, then if $x^n=x\succsim y^n$, by continuity, $y=\lim_{n\rightarrow \infty}y^n$, we have $x\succsim y$, hence the lower contour set is closed; the upper contour set can be proved the same way.
    \item[-] contour set closedness $\rightarrow$ continuity: Suppose $\exists \left\{x^n\right\},\left\{y^n\right\}\in X$ s.t. $\forall n, x^n\succsim y^n$, $x^n\rightarrow x\in X, y^n\rightarrow y\in X$ and $y\succ x$. We know both $\left\{z\in X\mid y\succ z \right\}$ and $\left\{z\in X\mid z\succ x \right\}$ are open, hence $\exists N_1,N_2\in \mathbb{Z}^+$ s.t. $y\succ x^n,\forall n>N_1$,
\end{enumerate}